{% extends 'blog/base2.html' %}
{% load blog_tags %}
{% load static %}


 {% block header %}

    <!-- Page Header -->
    <!-- Set your background image for this header on the line below. -->
    <header class="intro-header" style="background-image: url({% static 'blog/img/home-bg.jpg' %})">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <div class="post-heading">
                        <h1>{{ post.title }}</h1>
                        <span class="meta">Posted by <a href="{% url 'blog:author' post.author %}">{{ post.author }}</a> on {{ post.created_time }},{% get_view_num  post.id  %} readed</span>
                    </div>
                </div>
            </div>
        </div>
    </header>
{% endblock header %}
{% block main %}
    <!-- Post Content -->
    <article>
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    {{ post.body|safe }}
                    <span>Last Modified·{{ post.modified_time }}</span>

                                                 <!-- Pager -->
                <ul class="pager">
                    {% if pre_post %}
                     <li class="previous">

		                <a href="{% url 'blog:detail' pre_post.id  %}">&larr; {{ pre_post.title|striptags|truncatechars:15 }} </a>

                    </li>
                    {% endif %}
                    {% if next_post %}
                    <li class="next">

                        <a href="{% url 'blog:detail' next_post.id  %}">{{ next_post.title|striptags|truncatechars:15 }} &rarr;</a>

                    </li>
                    {% endif %}
                </ul>
                </div>
            </div>
            </div>




    </article>


    <hr>



{% endblock main %}

{% load comments %}

{% block blog_content %}


        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
    <div class="panel panel-default">
        <div class="panel-heading">
            <h4>评论列表</h4>
        </div>

        <div class="panel-body">
            {% get_comment_list for post as comments %}
            {% for comment in comments %}
                <div class="blog_comment" name="F{{comment.id}}">
                    <p class="comment_title"><span style="float:right">{{ forloop.counter }}#</span>{{ comment.submit_date|date:"Y-m-d H:i"}} @ {{ comment.user_name }}：</p>
                    <p class="comment_content">{{ comment.comment|safe }}</p>
                    <hr>
                </div>

            {% empty %}
                暂无评论
            {% endfor %}
        </div>
    </div>
                        </div>
                    </div>
                </div>
{% endblock %}

{% block other %}



        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
    <div class="comments_nav">
        {% if user.is_authenticated %}
    {% if user.is_active %}
          <script src="https://cdn.bootcss.com/ckeditor/4.6.2/ckeditor.js"></script>
        <h4>新的评论</h4>
        {% get_comment_form for post as blog_form %}
            <form class="form-horizontal" action="{% comment_form_target %}" method="post" id="comment_form">
        {% csrf_token %}

        {{ blog_form.object_pk }}
        {{ blog_form.content_type }}
        {{ blog_form.timestamp }}
        {{ blog_form.site }}
        {{ blog_form.submit_date }}
        {{ blog_form.security_hash }}


        <input type="hidden" name="next" value="{%url 'blog:detail' post.id%}"/>
        <input id="reply_to" type="hidden" name="reply_to" value="0" />
        <input id="root_id" type="hidden" name="root_id" value="0" />
        <input id="reply_name" type="hidden" name="reply_name" value="">

        <div class="row">
            <div class="col-lg-12 col-md-12 ">
                <textarea class="input-xlarge comment_text" id="id_comment" name="comment" placeholder="为了防止垃圾评论，需要登录，才能评论哦~"></textarea>
                <script>
                // Replace the <textarea id="editor1"> with a CKEditor
                // instance, using default configuration.
                CKEDITOR.replace( 'id_comment' );
                </script>

                <!--如果你在该字段中输入任何内容，你的评论就会被视为垃圾评论-->
                <input type="text" style="display:none;" id="id_honeypot" name="honeypot">
            </div>
        </div>

        <div class="row ">
              <div class="form-actions comment_button" style="float:right;">
                <span id='tip_text'></span>
                <input class="btn btn-info" id="submit_btn" type="submit" name="submit" value="提交"/>

              </div>
        </div>
     </form>
                                {% else %}
                    您尚未激活，请先激活您的账户才能评论。(避免垃圾评论)
                {% endif %}
                {% else %}
                    <p style="text-align:center">您尚未登录，请先<a href="{%url 'admin:login' %}?next={{post.get_absolute_url}}">登录</a>才能评论。</p>
                {% endif %}
    </div>

                      </div>
                    </div>
                </div>



{% endblock %}

                        {% block loginnext %}
                        ·已登录 by <a title="退出登录" href="{%url 'admin:logout' %}?next={{post.get_absolute_url}}">{{user.get_username}}</a>
                        {% endblock loginnext %}